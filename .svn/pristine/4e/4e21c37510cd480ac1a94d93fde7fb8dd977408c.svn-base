<?php
/*
|--------------------------------------------------------------------------
| 用户文章生成
|--------------------------------------------------------------------------
|
| This value is the name of your application. This value is used when the
| framework needs to place the application's name in a notification or
| any other location as required by the application or its packages.
|
*/


class ArticleService extends BaseService
{
	public static $key = 'userlist';

	public static $num = 5; // 每次处理多少条数据

	public function article() {

		$list = $this->rpop();
		
		if( empty($list) )
			throw new Exception("redis 列表中有空数据，请检查！", 1);


		$a = array_slice($list, 0, self::$num); //取数组前多少条

		$b = array_slice($list, self::$num, count($list));  

		if( !empty($b) ) { //剩余的继续塞进队列
			$this->lpush( $b );
		}

		//  2:2470:11,13,16:19,21,24:8

		


			

		print_r($a) ;

		print_r($b) ;
	}

    /**
    * 从队列拿数据
    *
    * @var array
    */
	public function rpop() {
		$list = $this->redis->rpop(self::$key,'l');
		@$list = json_decode( $list , true );
		return $list;
	}

	/**
	* 向队列压数据
	*
	* @var array
	*/
	public function lpush( $arr ) {
		if(is_array( $arr ))
			$ret = $this->redis->lpush( self::$key, json_encode($arr), 'l');

	}
	
}